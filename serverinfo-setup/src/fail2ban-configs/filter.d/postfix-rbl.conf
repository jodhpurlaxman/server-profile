# Fail2Ban filter for postfix RBL rejections
[INCLUDES]
before = common.conf

[Definition]
_daemon = postfix/smtpd

# Match RBL (Real-time Blackhole List) rejections
failregex = ^%(__prefix_line)sNOQUEUE: reject: RCPT from [^[]*\[<HOST>\].*blocked using.*$
            ^%(__prefix_line)sNOQUEUE: reject: RCPT from [^[]*\[<HOST>\].*Service unavailable; .* blocked using.*$
            ^%(__prefix_line)sNOQUEUE: reject: RCPT from [^[]*\[<HOST>\].*Client host rejected: .*rbl.*$

ignoreregex =

[Init]
journalmatch = _SYSTEMD_UNIT=postfix@-.service
